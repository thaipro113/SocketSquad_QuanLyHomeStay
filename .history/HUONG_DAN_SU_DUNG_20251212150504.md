
# Hướng Dẫn Cài Đặt và Sử Dụng - Hệ Thống Quản Lý Homestay

## 1. Yêu cầu hệ thống
-   **Java JDK**: Phiên bản 22 hoặc mới hơn nếu chưa tải bản mới thì hãy tải về xong thêm vào theo luồng sau: File → Project Structure → Project SDK → Add JDK → chọn đường dẫn JDK mới.
-   **SQL Server**: Đã cài đặt và đang chạy.
-   **Maven** (Tùy chọn, nếu muốn build bằng Maven).

## 2. Cài đặt Cơ sở dữ liệu (Database)
1.  Mở **SQL Server Management Studio (SSMS)**.
2.  Mở file `database.sql` nằm trong thư mục gốc của dự án.
3.  Chạy toàn bộ script (Execute) để tạo database `HomestayDB` và các bảng cần thiết.
4.  **Quan trọng**: Mở file `src/main/java/server/database/DBConnection.java`.
5.  Cập nhật thông tin kết nối cho phù hợp với máy của bạn:
    ```java
    private static final String URL = "jdbc:sqlserver://localhost:1433;databaseName=HomestayDB;encrypt=true;trustServerCertificate=true";
    private static final String USER = "sa"; // Tên đăng nhập SQL của bạn
    private static final String PASSWORD = "password"; // Mật khẩu SQL của bạn
    ```

## 3. Cách chạy ứng dụng

### Bước 1: Chạy Server
Mở terminal (CMD hoặc PowerShell) tại thư mục gốc của dự án và chạy lệnh sau:

**Biên dịch (Compile):**
```bash
javac -cp ".;libs/*" src/main/java/server/ServerApp.java
```

**Chạy (Run):**
```bash
java -cp ".;libs/*" server.ServerApp
```
*Lưu ý: Đảm bảo bạn đã tải thư viện `mssql-jdbc` và đặt vào thư mục `libs` (hoặc cấu hình Maven để tự tải).*

### Bước 2: Chạy Client
Mở một terminal **khác** và chạy lệnh sau:

**Biên dịch (Compile):**
```bash
javac -cp ".;libs/*" src/main/java/client/ClientApp.java
```

**Chạy (Run):**
```bash
java -cp ".;libs/*" client.ClientApp
```

## 4. Hướng dẫn sử dụng

### Đăng nhập
-   **Username**: `admin`
-   **Password**: `admin123`

### Quản lý Phòng (Rooms)
-   Vào tab **Rooms**.
-   Nhấn **Add Room** để thêm phòng mới.
-   Điền tên, giá, trạng thái.
-   Nhấn **Select Image** để tải ảnh phòng lên Server.

### Quản lý Khách thuê (Tenants)
-   Vào tab **Tenants**.
-   Nhấn **Add Tenant**.
-   Nhập thông tin khách và **Room ID** (ID của phòng khách thuê).

### Quản lý Hóa Đơn & Trả Phòng (Checkout)
-   **Trả Phòng**:
    -   Vào tab **Quản Lý Phòng**.
    -   Chọn một phòng đang ở trạng thái **ĐANG THUÊ** (OCCUPIED).
    -   Nhấn nút **Trả Phòng**.
    -   Hệ thống sẽ hiển thị bảng tính tiền chi tiết:
        -   **Ngày vào / Ngày ra**: Tự động lấy từ dữ liệu thuê.
        -   **Tiền Phòng**: Tính tự động theo giờ hoặc ngày.
        -   **Điện / Nước**: Nhập chỉ số mới (Hệ thống tự trừ đi chỉ số cũ).
    -   Nhấn **OK** để hoàn tất. Hóa đơn sẽ được tạo với trạng thái **ĐÃ THANH TOÁN**.

-   **Xem Hóa Đơn**:
    -   Vào tab **Hóa Đơn & Chi Phí** để xem lịch sử thanh toán.

### Thống Kê (Statistics)
-   Vào tab **Thống Kê**.
-   Xem tổng quan tình hình kinh doanh:
    -   **Tổng Doanh Thu**: Tổng tiền từ các hóa đơn đã thanh toán.
    -   **Khách Đang Thuê**: Số lượng khách đang ở.
    -   **Khách Đã Trả Phòng**: Số lượng lượt khách đã phục vụ (theo hóa đơn).
    -   **Tỉ Lệ Lấp Đầy**: Phần trăm phòng đang có khách.
-   Nhấn nút **Cập Nhật** để làm mới số liệu.

## 5. Khắc phục lỗi thường gặp
-   **Lỗi kết nối Database**: Kiểm tra lại username/password trong `DBConnection.java` và đảm bảo SQL Server đang chạy.
-   **Lỗi thiếu thư viện**: Đảm bảo file `.jar` của driver SQL Server (`mssql-jdbc`) đã có trong classpath hoặc thư mục `libs`.
